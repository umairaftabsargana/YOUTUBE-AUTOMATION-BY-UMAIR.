<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Automation By UMAIR</title>
    <style>
        /* --- General Styling --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #e9eef2;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 25px;
            background-color: #ffffff;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
        }

        h1 {
            text-align: center;
            color: #c4302b; /* YouTube Red */
            margin-bottom: 40px;
            font-size: 2.5em;
            letter-spacing: 1px;
        }

        /* --- Navigation Tabs --- */
        .workflow-tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            border-bottom: 3px solid #ddd;
            background-color: #f8f8f8;
            border-radius: 8px 8px 0 0;
        }

        .tab-button {
            flex-grow: 1;
            background-color: transparent;
            border: none;
            padding: 15px 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            color: #555;
            transition: all 0.3s ease;
            text-align: center;
        }

        .tab-button.active {
            color: #c4302b;
            border-bottom: 3px solid #c4302b;
            background-color: #fff;
        }

        .tab-button:hover:not(.active) {
            color: #000;
        }

        /* --- Content Sections --- */
        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }

        .feature-box {
            display: flex;
            gap: 30px;
        }

        /* --- Input and Output Areas --- */
        .input-area, .output-area {
            flex: 1;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fdfdfd;
        }

        .input-area h3, .output-area h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-top: 10px;
            font-weight: 600;
            color: #333;
        }

        textarea, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus, input:focus {
            border-color: #c4302b;
            outline: none;
        }

        textarea {
            min-height: 250px;
        }
        
        /* New Instruction Area Styling */
        .instruction-area {
            min-height: 80px; /* Smaller height for optional instruction */
        }

        /* --- Buttons --- */
        .generate-btn, .copy-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s;
            text-transform: uppercase;
            width: 100%;
            margin-top: 15px;
        }
        
        .generate-btn {
            background-color: #4CAF50; /* Green for Generate */
            color: white;
        }

        .generate-btn:hover {
            background-color: #45a049;
            transform: translateY(-1px);
        }

        .copy-btn {
            background-color: #2196F3; /* Blue for Copy */
            color: white;
        }

        .copy-btn:hover {
            background-color: #1a83e0;
            transform: translateY(-1px);
        }

        /* --- Error Handling & Loading --- */
        .error-message {
            color: #ff0000;
            background-color: #ffeaea;
            border: 1px solid #ff0000;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-weight: 500;
            display: none;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #c4302b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Custom Alert Modal --- */
        .custom-alert {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }

        .alert-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            border-radius: 8px;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
            text-align: center;
        }

        .alert-close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .alert-close-btn:hover,
        .alert-close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        /* --- Contact Info Footer --- */
        .footer-contact {
            text-align: center;
            padding-top: 20px;
            margin-top: 30px;
            border-top: 1px solid #ddd;
            font-size: 0.9em;
            color: #555;
        }

        .footer-contact strong {
            color: #333;
        }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            .container {
                margin: 20px;
                padding: 15px;
            }
            .feature-box {
                flex-direction: column;
            }
            .workflow-tabs {
                flex-wrap: wrap;
            }
            .tab-button {
                flex-basis: 50%;
                border-radius: 0;
            }
            .input-area, .output-area {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p style="margin-left: 10px; color: #c4302b;">Generating Content...</p>
    </div>

    <!-- Custom Alert Modal -->
    <div id="custom-alert" class="custom-alert">
        <div class="alert-content">
            <span class="alert-close-btn" onclick="closeAlert()">&times;</span>
            <p id="alert-message"></p>
        </div>
    </div>

    <div class="container">
        <h1>ðŸŽ¥ YouTube Automation By UMAIR</h1>

        <!-- Workflow Tabs -->
        <div class="workflow-tabs">
            <button class="tab-button active" onclick="openTab('title-generator', this)">1. Title Generator</button>
            <button class="tab-button" onclick="openTab('script-generator', this)">2. Script Generator</button>
            <button class="tab-button" onclick="openTab('image-prompt-generator', this)">3. Image Prompt Generator</button>
        </div>

        <!-- Title Generator Section -->
        <div id="title-generator" class="tab-content active">
            <div class="feature-box">
                <div class="input-area">
                    <h3>Input Details for Titles</h3>
                    <label for="title-topic">Video Topic or Niche:</label>
                    <input type="text" id="title-topic" placeholder="e.g., How to make money with AI art">

                    <label for="title-count">Number of Titles (1â€“500):</label>
                    <input type="number" id="title-count" min="1" max="500" value="10">

                    <!-- NEW: Instruction Optional Field -->
                    <label for="title-instruction">Instruction (Optional):</label>
                    <textarea id="title-instruction" class="instruction-area" placeholder="e.g., Use emojis, or avoid numbers in the titles."></textarea>
                    
                    <div class="error-message" id="title-error"></div>

                    <button class="generate-btn" onclick="generateTitles()">Generate Titles</button>
                </div>
                <div class="output-area">
                    <h3>Generated Titles (SEO-Friendly)</h3>
                    <textarea id="titles-output" readonly placeholder="Unique, catchy, and SEO-friendly YouTube titles will appear here, one per line."></textarea>
                    <button class="copy-btn" onclick="copyContent('titles-output')">Copy All Titles</button>
                </div>
            </div>
        </div>

        <!-- Script Generator Section -->
        <div id="script-generator" class="tab-content">
            <div class="feature-box">
                <div class="input-area">
                    <h3>Input Details for Script</h3>
                    <label for="script-title">Video Title:</label>
                    <input type="text" id="script-title" placeholder="e.g., The ULTIMATE 2024 Guide to AI Art Profits">
                    
                    <label for="script-word-count">Approximate Word Count (100â€“20,000):</label>
                    <input type="number" id="script-word-count" min="100" max="20000" value="1000">

                    <!-- NEW: Instruction Optional Field -->
                    <label for="script-instruction">Instruction (Optional):</label>
                    <textarea id="script-instruction" class="instruction-area" placeholder="e.g., Write in a casual and energetic tone, or include a historical anecdote."></textarea>
                    
                    <div class="error-message" id="script-error"></div>
                    
                    <button class="generate-btn" onclick="generateScript()">Generate Full Script</button>
                </div>
                <div class="output-area">
                    <h3>
                        Generated Video Script 
                        <!-- NEW WORD COUNT DISPLAY -->
                        <span id="script-word-count-display" style="font-size: 0.8em; color: #555; font-weight: normal;">(Words: 0)</span>
                    </h3>
                    <textarea id="script-output" readonly placeholder="The full, structured script (Introduction, Body, Conclusion, optional CTA) will appear here."></textarea>
                    <button class="copy-btn" onclick="copyContent('script-output')">Copy Script</button>
                </div>
            </div>
        </div>

        <!-- Image Prompt Generator Section -->
        <div id="image-prompt-generator" class="tab-content">
            <div class="feature-box">
                <div class="input-area">
                    <h3>Input Details for Prompts</h3>
                    <label for="prompt-script">Paste Video Script Here (max 20,000 words):</label>
                    <textarea id="prompt-script" placeholder="Paste the generated script from the previous section or any full script."></textarea>

                    <label for="scene-count">Number of Scenes (3â€“200):</label>
                    <input type="number" id="scene-count" min="3" max="200" value="10">

                    <!-- NEW: Instruction Optional Field -->
                    <label for="prompt-instruction">Instruction (Optional):</label>
                    <textarea id="prompt-instruction" class="instruction-area" placeholder="e.g., Use a cyberpunk aesthetic for all images, or ensure the aspect ratio is 16:9."></textarea>
                    
                    <div class="error-message" id="prompt-error"></div>

                    <button class="generate-btn" onclick="generatePrompts()">Generate Image Prompts</button>
                </div>
                <div class="output-area">
                    <h3>Generated AI Image Prompts</h3>
                    <textarea id="prompts-output" readonly placeholder="Detailed, cinematic image prompts (one paragraph per scene) for MidJourney/Stable Diffusion will appear here."></textarea>
                    <button class="copy-btn" onclick="copyContent('prompts-output')">Copy All Prompts</button>
                </div>
            </div>
        </div>
        
        <!-- Contact Info Footer -->
        <div class="footer-contact">
            <p>Developed By: <strong>UMAIR</strong> | WhatsApp: <strong>0300-6506794</strong></p>
        </div>

    </div>

    <script>
        // --- GEMINI API Setup ---
        const MODEL_NAME = "gemini-2.5-flash-preview-09-2025";
        // API key will be provided at runtime by the environment.
        const apiKey = "AIzaSyDWUQipDt65vgv7mxPeh6R_iSWCjguppgs"; 
        const API_CALL_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`;

        // --- Utility Functions ---

        function showLoading() {
            document.getElementById('loading-overlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
        }
        
        function showAlert(message) {
            document.getElementById('alert-message').textContent = message;
            document.getElementById('custom-alert').style.display = 'block';
        }

        function closeAlert() {
            document.getElementById('custom-alert').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('custom-alert');
            if (event.target == modal) {
                closeAlert();
            }
        }
        
        async function fetchWithRetry(url, payload, retries = 5) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.status === 429 && i < retries - 1) {
                        // Rate limit exceeded, wait and retry
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    }

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error: ${response.status} - ${errorData.error.message}`);
                    }

                    return response.json();

                } catch (error) {
                    if (i === retries - 1) {
                        throw new Error(`Failed to fetch content after ${retries} attempts. Error: ${error.message}`);
                    }
                }
            }
        }

        // --- UI & Content Copy ---

        function openTab(tabId, clickedButton) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            clickedButton.classList.add('active');
        }

        // Helper function to update the word count display
        function updateWordCountDisplay(elementId, displayId) {
            const text = document.getElementById(elementId).value;
            // Simple word count: split by whitespace and filter out empty strings
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            document.getElementById(displayId).textContent = `(Words: ${wordCount})`;
        }


        document.addEventListener('DOMContentLoaded', () => {
            openTab('title-generator', document.querySelector('.tab-button'));
            
            // Add event listener for dynamic word count update on the script output textarea
            document.getElementById('script-output').addEventListener('input', () => {
                updateWordCountDisplay('script-output', 'script-word-count-display');
            });
        });

        function copyContent(elementId) {
            const copyTextarea = document.getElementById(elementId);
            
            if (!copyTextarea.value.trim()) {
                showAlert("Nothing to copy! Generate content first.");
                return;
            }

            copyTextarea.select();
            copyTextarea.setSelectionRange(0, 99999);

            try {
                document.execCommand('copy');
                showAlert("Content copied to clipboard!");
            } catch (err) {
                showAlert("Could not copy text. Please try manually.");
            }
        }

        // --- Feature 1: Title Generator ---

        async function generateTitles() {
            const topicInput = document.getElementById('title-topic');
            const countInput = document.getElementById('title-count');
            const instructionInput = document.getElementById('title-instruction'); // Instruction Field
            const outputArea = document.getElementById('titles-output');
            const errorElement = document.getElementById('title-error');
            
            errorElement.style.display = 'none';
            outputArea.value = '';

            const topic = topicInput.value.trim();
            const count = parseInt(countInput.value, 10);
            const instruction = instructionInput.value.trim(); // Get instruction

            if (!topic) {
                errorElement.textContent = "Please enter a video topic or niche.";
                errorElement.style.display = 'block';
                return;
            }

            if (isNaN(count) || count < 1 || count > 500) {
                errorElement.textContent = "Number of titles must be between 1 and 500.";
                errorElement.style.display = 'block';
                return;
            }
            
            showLoading();

            let userQuery = `Generate exactly ${count} SEO-friendly YouTube video titles for the topic: "${topic}". Format them as a numbered list, one title per line.`;
            
            // Apply instruction if provided
            if (instruction) {
                userQuery = `Instruction to prioritize: "${instruction}". Then, ` + userQuery;
            }

            const systemPrompt = "You are an expert YouTube title generator specializing in creating clickable, high-CTR, SEO-optimized titles. Use power words, curiosity gaps, and include the main topic prominently. Do not include any introductory or concluding text, only the numbered list.";

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await fetchWithRetry(API_CALL_URL, payload);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    outputArea.value = text.trim();
                } else {
                    showAlert("Title generation failed. No content was returned.");
                }

            } catch (error) {
                console.error('Title generation API error:', error);
                showAlert(`Error generating titles: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // --- Feature 2: Script Generator (UPDATED FOR CLEAN VOICEOVER AND WORD COUNT) ---

        async function generateScript() {
            const titleInput = document.getElementById('script-title');
            const countInput = document.getElementById('script-word-count');
            const instructionInput = document.getElementById('script-instruction'); // Instruction Field
            const outputArea = document.getElementById('script-output');
            const errorElement = document.getElementById('script-error');

            errorElement.style.display = 'none';
            outputArea.value = '';

            // Reset word count display before generation
            document.getElementById('script-word-count-display').textContent = '(Words: 0)';

            const title = titleInput.value.trim();
            const count = parseInt(countInput.value, 10);
            const instruction = instructionInput.value.trim(); // Get instruction

            if (!title) {
                errorElement.textContent = "Please enter a video title to generate a script.";
                errorElement.style.display = 'block';
                return;
            }
            
            if (isNaN(count) || count < 100 || count > 20000) {
                errorElement.textContent = "Word count must be between 100 and 20,000 words.";
                errorElement.style.display = 'block';
                return;
            }

            showLoading();

            let userQuery = `Write a full video script of approximately ${count} words for the title: "${title}". The script must be structured with four clear sections, separated by simple capitalized titles: INTRODUCTION, BODY, CONCLUSION, and CALL TO ACTION. The entire content must be in simple, clean paragraphs, perfect for voiceover.`;
            
            // Apply instruction if provided
            if (instruction) {
                userQuery = `Instruction to prioritize: "${instruction}". Then, ` + userQuery;
            }
            
            // --- SYSTEM PROMPT ---
            const systemPrompt = "You are a professional scriptwriter for faceless YouTube automation channels. Your script must be delivered in simple, clean, continuous paragraphs, ready for direct voiceover reading. Absolutely DO NOT use Markdown formatting like hashtags (#), stars (*), bullet points, numbered lists, or bolding. Use capitalized section titles with two line breaks (like 'INTRODUCTION\n\n') followed by the script content. Ensure the output is ready to use without any modification.";

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await fetchWithRetry(API_CALL_URL, payload);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    outputArea.value = text.trim();
                    // Update word count after successful generation
                    updateWordCountDisplay('script-output', 'script-word-count-display');
                } else {
                    showAlert("Script generation failed. No content was returned.");
                }

            } catch (error) {
                console.error('Script generation API error:', error);
                showAlert(`Error generating script: ${error.message}`);
            } finally {
                hideLoading();
            }
        }
        
        // --- Feature 3: Image Prompt Generator (Uses Structured Output) ---

        async function generatePrompts() {
            const scriptInput = document.getElementById('prompt-script');
            const sceneCountInput = document.getElementById('scene-count');
            const instructionInput = document.getElementById('prompt-instruction'); // Instruction Field
            const outputArea = document.getElementById('prompts-output');
            const errorElement = document.getElementById('prompt-error');

            errorElement.style.display = 'none';
            outputArea.value = '';

            const script = scriptInput.value.trim();
            const count = parseInt(sceneCountInput.value, 10);
            const instruction = instructionInput.value.trim(); // Get instruction

            if (!script) {
                errorElement.textContent = "Please paste the video script to analyze the scenes.";
                errorElement.style.display = 'block';
                return;
            }

            if (isNaN(count) || count < 3 || count > 200) {
                errorElement.textContent = "Number of scenes must be between 3 and 200.";
                errorElement.style.display = 'block';
                return;
            }

            showLoading();
            
            let userQuery = `Analyze the provided video script and break it down into approximately ${count} distinct visual scenes. For each scene, generate a single, detailed, cinematic image prompt. The prompt must include a description of the scene, atmosphere, lighting, and a cinematic style suitable for an AI image generator. Script: "${script}"`;
            
            // Apply instruction if provided
            if (instruction) {
                userQuery = `Instruction to prioritize: "${instruction}". Then, ` + userQuery;
            }

            const systemPrompt = "You are an expert AI image prompt engineer. Your task is to translate narrative text into vivid, actionable visual prompts, ensuring high quality and visual impact for faceless video content. Focus on detailed descriptions suitable for generators like MidJourney or Stable Diffusion. Do not include any numbering or extra text outside the JSON structure.";

            const responseSchema = {
                type: "ARRAY",
                items: {
                    type: "OBJECT",
                    properties: {
                        "scene_number": { "type": "INTEGER" },
                        "image_prompt": { "type": "STRING", "description": "The detailed cinematic image prompt in a single paragraph, ready for an AI generator. Example: A lone digital figure sitting on a vast mountain top, illuminated by a brilliant, digital sunset. Cinematic, wide shot, deep focus, neon accents, 8k, photorealistic." }
                    },
                    "propertyOrdering": ["scene_number", "image_prompt"]
                }
            };
            
            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema
                }
            };

            try {
                const result = await fetchWithRetry(API_CALL_URL, payload);
                const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (jsonText) {
                    const parsedJson = JSON.parse(jsonText);
                    const formattedOutput = parsedJson.map(item => 
                        `Scene ${item.scene_number}:\n${item.image_prompt}`
                    ).join('\n\n---\n\n');
                    
                    outputArea.value = formattedOutput.trim();
                } else {
                    showAlert("Prompt generation failed. Check the script content and try again.");
                }

            } catch (error) {
                console.error('Prompt generation API error:', error);
                showAlert(`Error generating prompts. Ensure your script is valid. Error: ${error.message}`);
            } finally {
                hideLoading();
            }
        }
    </script>

</body>

</html>
